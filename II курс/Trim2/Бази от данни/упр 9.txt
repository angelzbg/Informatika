CREATE DATABASE SALES3 
GO 
USE SALES3 
GO 
CREATE TABLE PRODUCTS 
( 
PROD_ID INT PRIMARY KEY IDENTITY, 
NAME VARCHAR(100) NOT NULL, 
UNIT_PRICE DECIMAL(7,2) 
) 

CREATE TABLE SELLERS 
( 
EIK CHAR(10) PRIMARY KEY, 
NAME VARCHAR(50) NOT NULL 
) 

CREATE TABLE SELLER_PRODUCTS 
( 
EIK CHAR(10) FOREIGN KEY REFERENCES SELLERS ON DELETE CASCADE, 
PROD_ID INT FOREIGN KEY REFERENCES PRODUCTS, 
SOLD_NUMBER DECIMAL NOT NULL, 
TIMESTAMP DATETIME DEFAULT GETDATE(), 
PRIMARY KEY (EIK, PROD_ID) 
) 

ALTER TABLE PRODUCTS 
ADD DATE DATE NOT NULL 

INSERT INTO PRODUCTS 
VALUES ('AAA', 15.00, GETDATE()) 

INSERT INTO SELLERS 
VALUES ('1010101010', 'Ivan Ivanov') 

INSERT INTO SELLER_PRODUCTS (EIK, PROD_ID, SOLD_NUMBER) 
VALUES ('1010101010', 1, 50) 

UPDATE PRODUCTS 
SET NAME = 'BBB', UNIT_PRICE = 50.00 
WHERE PROD_ID = 1 

DELETE FROM PRODUCTS 
WHERE NAME LIKE 'Pe%' AND UNIT_PRICE >= 50 

USE PCTRADE_INF1A 

SELECT NAME 
FROM DEPARTMENTS 
WHERE CITY = 'Seattle' 
ORDER BY NAME DESC 

SELECT NAME, LNAME 
FROM DEPARTMENTS D LEFT JOIN EMPLOYEES E 
ON D.MANAGER_ID = E.EMPLOYEE_ID 

SELECT NAME, COUNT(*) 
FROM PRODUCTS P JOIN ORDER_ITEMS OI 
ON P.PRODUCT_ID = OI.PRODUCT_ID 
GROUP BY NAME 
HAVING COUNT(*) > 2 

CREATE VIEW CUSTOMERS_ORDERS2 
AS 
SELECT FNAME, LNAME, COUNT(ORDER_ID) AS COUNT 
FROM CUSTOMERS C LEFT JOIN ORDERS O 
ON C.CUSTOMER_ID = O.CUSTOMER_ID 
GROUP BY C.CUSTOMER_ID, FNAME, LNAME 