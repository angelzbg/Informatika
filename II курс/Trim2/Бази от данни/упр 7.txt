/*Изведете имената на продуктите, които са били поръчвани*/ 
SELECT DISTINCT NAME 
FROM ORDER_ITEMS OI JOIN PRODUCTS P 
ON P.PRODUCT_ID = OI.PRODUCT_ID 

SELECT NAME 
FROM PRODUCTS 
WHERE PRODUCT_ID IN (SELECT PRODUCT_ID 
                     FROM ORDER_ITEMS) 

SELECT NAME 
FROM PRODUCTS 
WHERE EXISTS (SELECT * 
              FROM ORDER_ITEMS 
              WHERE PRODUCTS.PRODUCT_ID = ORDER_ITEMS.PRODUCT_ID) 

SELECT NAME 
FROM PRODUCTS 
WHERE PRODUCT_ID = ANY (SELECT PRODUCT_ID 
                        FROM ORDER_ITEMS) 

/*Изведете имената на служителите, които получват заплата 
по-голяма от средната заплата на отдела, в който работят*/ 
SELECT FNAME, LNAME, SALARY, DEPARTMENT_ID 
FROM EMPLOYEES E 
WHERE SALARY > (SELECT AVG(SALARY) 
                FROM EMPLOYEES 
                WHERE DEPARTMENT_ID = E.DEPARTMENT_ID) 


/*Изведете имената и длъжностите на служителите, които са 
назначени след 15.05.1999*/ 

SELECT FNAME, LNAME, HIRE_DATE, JOB_TITLE 
FROM EMPLOYEES E JOIN JOBS J 
ON E.JOB_ID = J.JOB_ID 
WHERE HIRE_DATE > '1999-05-15' 
ORDER BY 3 

SELECT FNAME, LNAME, HIRE_DATE, JOB_TITLE 
FROM EMPLOYEES E JOIN JOBS J 
ON E.JOB_ID = J.JOB_ID 
WHERE HIRE_DATE > '15.05.1999' 
ORDER BY 3 

SELECT FNAME, LNAME, HIRE_DATE, JOB_TITLE 
FROM EMPLOYEES E JOIN JOBS J 
ON E.JOB_ID = J.JOB_ID 
WHERE HIRE_DATE > CAST('15.05.1999' AS DATETIME) 
ORDER BY 3 

SELECT FNAME, LNAME, HIRE_DATE, JOB_TITLE 
FROM EMPLOYEES E JOIN JOBS J 
ON E.JOB_ID = J.JOB_ID 
WHERE HIRE_DATE > CONVERT(DATETIME,'15.05.1999', 104) 
ORDER BY 3 

/*Изведете номерата и датите на поръчките и тяхното съдържание, 
нека датата на поръчката бъде изведете в стил 109*/ 

SELECT O.ORDER_ID, CONVERT(VARCHAR, ORDER_DATE, 109), 
PRODUCT_ID, UNIT_PRICE, QUANTITY 
FROM ORDERS O, ORDER_ITEMS OI 
WHERE O.ORDER_ID = OI.ORDER_ID 

SELECT SYSDATETIME() 
SELECT SYSDATETIMEOFFSET() 
SELECT GETDATE() 

SELECT HIRE_DATE, DATENAME(MONTH, HIRE_DATE), 
DATEPART(MONTH, HIRE_DATE), MONTH(HIRE_DATE) 
FROM EMPLOYEES 

SELECT DATENAME(WEEKDAY, GETDATE()), DATEPART(WEEKDAY, GETDATE()) 

SELECT DATEFROMPARTS ( 2010, 12, 31 ) AS Result; 

SELECT DATETIME2FROMPARTS ( 2010, 12, 31, 23, 59, 59, 0, 0 )  

SELECT DATEDIFF(DAY, GETDATE(), '2018-03-07') 

/*Изведете номерата на поръчките, техните дати и ако всяка 
поръчка трябва да бъде платена 7 дни след като е направена 
изведете датата, на която трябва да бъде платена*/ 

SELECT ORDER_ID, CONVERT(VARCHAR,ORDER_DATE, 109), 
CONVERT(VARCHAR,DATEADD(DAY, 7, ORDER_DATE), 109) 
FROM ORDERS 
